# I/O Scheduler udev rules
# Generated by Ansible system tuning role
#
# This file configures I/O schedulers for storage devices based on their type
# NVMe devices: none (bypass kernel scheduler)
# SSDs: mq-deadline (good for solid state)
# HDDs: bfq (fairness for rotating media)

{% if optimized_storage_devices is defined %}
{% for device in optimized_storage_devices %}
# {{ device.name }} ({{ device.type }}): {{ device.scheduler }}
ACTION=="add|change", KERNEL=="{{ device.name }}", ATTR{queue/scheduler}="{{ device.scheduler }}"
{% endfor %}
{% endif %}

{% if tuning_io_scheduler_devices is defined and tuning_io_scheduler_devices | length > 0 %}
# Legacy configuration (backwards compatibility)
{% for device in tuning_io_scheduler_devices %}
ACTION=="add|change", KERNEL=="{{ device }}", ATTR{queue/scheduler}="{{ tuning_io_scheduler | default('mq-deadline') }}"
{% endfor %}
{% endif %}
